<!DOCTYPE html>
<html>
	<head>
		<title>DevSamurai - Pong</title>
	</head>
	<body>
		<canvas id="folha" width="600" height="500"/>
		<script type="text/javascript">		
			//variaveis
			var folhaDesenho = document.getElementById("folha");
			var areaDesenho = folhaDesenho.getContext("2d");
			var larguraCampo = 600;
			var alturaCampo = 500;
			var larguraLinha = 10;
			var diametroBola = 10;
			var posicaoBolaX = posicaoBolaY = 20;
			var velocidadeBolaX = velocidadeBolaY = 5;
			var espessuraRaquete = 11;
			var alturaRaquete = 100;
			var posicaoJogador1 = posicaoJogador2 = 40;
			var efeitoRaquete = 0.3;
			var pontuacaoJogador1 = 0;
			var pontuacaoJogador2 = 0;
			var velocidadeJogador2 = 5;
			//function
			window.onload = function(){
				setInterval(executar,1000/30); //30ms
			}
			//seguir mouse do Jogador 1
			folhaDesenho.addEventListener('mousemove', function(e){
				posicaoJogador1 = e.clientY - alturaRaquete / 2;
			});
			//base
			function executar(){
				//campo
				areaDesenho.fillStyle = "#286047";
				areaDesenho.fillRect(0,0,larguraCampo,alturaCampo); //x,y,larg,alt
				//linha
				areaDesenho.fillStyle = "#FFFFFF";
				areaDesenho.fillRect(larguraCampo/2 - larguraLinha/2,0,larguraLinha,alturaCampo);
				//raquete1
				areaDesenho.fillRect(0,posicaoJogador1,espessuraRaquete,alturaRaquete);			
				//raquete2
				areaDesenho.fillRect(larguraCampo - larguraLinha,posicaoJogador2,espessuraRaquete,alturaRaquete);
				//escrever a pontuação dos jogadores
				areaDesenho.fillText("Humano - " + pontuacaoJogador1 + " pontos", 100, 100);
				areaDesenho.fillText("Computador - " + pontuacaoJogador2 + " pontos", larguraCampo-200,100);
				//bola
				areaDesenho.fillRect(posicaoBolaX - diametroBola /2,posicaoBolaY - diametroBola/2,diametroBola,diametroBola);
				posicaoBolaX = posicaoBolaX + velocidadeBolaX;
				posicaoBolaY = posicaoBolaY + velocidadeBolaY;
				//verifica lateral superior
				if(posicaoBolaY < 0 && velocidadeBolaY < 0){
					velocidadeBolaY = -velocidadeBolaY;
				}
				//verifica lateral inferior
				if(posicaoBolaY > alturaCampo && velocidadeBolaY > 0){
					velocidadeBolaY = -velocidadeBolaY;
				}
				//verifica se o Jogador 2 fez um ponto
				if(posicaoBolaX < 0){
					if(posicaoBolaY > posicaoJogador1 && posicaoBolaY < posicaoJogador1 + alturaRaquete){
						//rebater a bola
						velocidadeBolaX = -velocidadeBolaX;
						var diferencaY = posicaoBolaY - (posicaoJogador1 + alturaRaquete / 2);
						velocidadeBolaY = diferencaY * efeitoRaquete;
					} else {
						//ponto para Jogador 2
						pontuacaoJogador2++;
						//coloca a bola no centro
						posicaoBolaX = larguraCampo /2;
						posicaoBolaY = alturaCampo / 2;
						velocidadeBolaX = -velocidadeBolaX;
						velocidadeBolaY =3;
					}
				}
				//verifica se o Jogador 1 fez um ponto
				if(posicaoBolaX > larguraCampo){
					if(posicaoBolaY > posicaoJogador2 && posicaoBolaY < posicaoJogador2 + alturaRaquete){
						//rebater a bola
						velocidadeBolaX = -velocidadeBolaX;
						var diferencaY = posicaoBolaY - (posicaoJogador2 + alturaRaquete / 2);
						velocidadeBolaY = diferencaY * efeitoRaquete;
					} else {
						//ponto para Jogador 1
						pontuacaoJogador1++;
						//coloca a bola no centro
						posicaoBolaX = larguraCampo /2;
						posicaoBolaY = alturaCampo / 2;
						velocidadeBolaX = -velocidadeBolaX;
						velocidadeBolaY =3;
						
					}
				}
				if(posicaoJogador2 + alturaRaquete / 2 < posicaoBolaY){
					posicaoJogador2 = posicaoJogador2 + velocidadeJogador2;
				} else {
					posicaoJogador2 = posicaoJogador2 - velocidadeJogador2;
				}
			}
		</script>
	</body>
</html>